---
// Importamos el Layout
import Layout from "../../layouts/Layout.astro"

// Importamos los componentes
import SectionContainer from "../../components/SectionContainer.astro"
import TitleSection from "../../components/TitleSection.astro"
import CodeIcon from "../../components/Icons/Code.astro"
import Link from "../../components/Icons/Link.astro"

// --- DATOS DE LA TAREA ---
const INFO_TAREA = {
  titulo: "Actividad 06: Implementaci√≥n de IPSec VPN (Site-to-Site)",
  fecha: "15 de Febrero, 2026",
  descripcion: "Configuraci√≥n integral de un t√∫nel VPN Site-to-Site mediante el protocolo IPSec en Cisco Packet Tracer para garantizar confidencialidad, integridad y autenticaci√≥n de datos.",
  pdf: "/pdfs/182217-Act06.pdf",
  imagen_demo: "/projects/Imagen2Tarea6.png" 
}
---

<Layout
  title={`Portafolio - ${INFO_TAREA.titulo}`}
  description={INFO_TAREA.descripcion}
>
  <style>
    :global(header) {
      display: none !important;
    }
  </style>

  <main class="px-4">
    <SectionContainer class="py-16 md:py-20">
      
      {/* --- ENCABEZADO DE LA TAREA --- */}
      <TitleSection>
        <CodeIcon class="size-8" />
        {INFO_TAREA.titulo}
      </TitleSection>
      
      <p class="text-sm text-gray-500 dark:text-gray-400 mb-8 -mt-4 border-b border-gray-200 dark:border-gray-800 pb-4">
        üìÖ Entregado el: {INFO_TAREA.fecha}
      </p>

      {/* --- CONTENIDO PRINCIPAL (R√öBRICA) --- */}
      <div class="prose dark:prose-invert max-w-none text-gray-800 dark:text-gray-200 space-y-10">
        
        {/* PUNTO 1. Introducci√≥n Contextual */}
        <div>
            <h3 class="text-2xl font-semibold mb-3 text-blue-500/80">1. Introducci√≥n y Topolog√≠a de Red</h3>
            <p class="mb-3 text-justify">
            Un t√∫nel Site-to-Site IPSec VPN act√∫a como un puente seguro entre distintas sedes corporativas, utilizando protocolos robustos para proteger el intercambio de datos a trav√©s de infraestructuras p√∫blicas como Internet. Su prop√≥sito esencial es establecer un canal privado y cifrado entre dos routers frontera, garantizando que la informaci√≥n viaje protegida de extremo a extremo.
            </p>
            <p class="text-justify">
            Esta operatividad se fundamenta en tres pilares de seguridad: <strong>Confidencialidad</strong> (evitar lecturas no autorizadas mediante cifrado), <strong>Integridad</strong> (asegurar que el dato no sea alterado en tr√°nsito) y <strong>Autenticaci√≥n</strong> (verificar la identidad de los extremos). La topolog√≠a emulada consta de un Sitio Local (R1 protegiendo la red 192.168.1.0/24), un Sitio Remoto (R3 protegiendo la red 192.168.3.0/24) y un Router ISP intermedio que √∫nicamente simula el transporte de paquetes p√∫blicos.
            </p>
        </div>

        {/* PUNTO 2. Desarrollo T√©cnico (EXTENSO) */}
        <div>
            <h3 class="text-2xl font-semibold mb-3 text-blue-500/80">2. Desarrollo T√©cnico: Configuraci√≥n Integral IPSec</h3>
            <p class="mb-4 text-justify">
            La implementaci√≥n de esta tecnolog√≠a requiri√≥ configurar meticulosamente tanto la infraestructura base de enrutamiento como los par√°metros criptogr√°ficos del t√∫nel. El proceso se dividi√≥ en las siguientes fases cr√≠ticas:
            </p>

            <h4 class="text-xl font-medium mb-2 text-gray-900 dark:text-white">A. Infraestructura Base y Licenciamiento</h4>
            <p class="mb-3 text-justify">
            Previo a cualquier configuraci√≥n criptogr√°fica, se estableci√≥ la conectividad b√°sica. Se asignaron IPs p√∫blicas en las interfaces WAN de R1 (209.165.100.1) y R3 (209.165.200.1), y se configur√≥ una ruta est√°tica por defecto (<code>ip route 0.0.0.0 0.0.0.0</code>) apuntando hacia el ISP. 
            </p>
            <p class="mb-5 text-justify">
            Un paso cr√≠tico en hardware Cisco (serie 1900) fue la activaci√≥n del m√≥dulo de seguridad. Mediante el comando <code>license boot module c1900 technology-package securityk9</code>, se instruy√≥ al sistema operativo para cargar los algoritmos criptogr√°ficos (AES, 3DES, SHA) necesarios para IPSec. Tras guardar la configuraci√≥n (<code>copy run start</code>), fue obligatorio realizar un reinicio f√≠sico (<code>reload</code>) del router para que la licencia tomara efecto.
            </p>

            <h4 class="text-xl font-medium mb-2 text-gray-900 dark:text-white">B. Fase 1: IKEv1 / ISAKMP (T√∫nel de Gesti√≥n)</h4>
            <p class="mb-3 text-justify">
            El protocolo ISAKMP establece un marco de confianza inicial antes de enviar datos de usuario. Creamos la pol√≠tica de seguridad (<code>policy 10</code>) donde se defini√≥ <strong>AES-256</strong> como algoritmo de cifrado para este canal de control. La validaci√≥n de identidades se configur√≥ mediante una llave precompartida (<code>authentication pre-share</code>) utilizando el valor "secretkey", mientras que la regeneraci√≥n de claves seguras se apoy√≥ en el algoritmo de Diffie-Hellman <strong>Grupo 5</strong>.
            </p>

            <h4 class="text-xl font-medium mb-2 text-gray-900 dark:text-white">C. Fase 2: IPSec y Tr√°fico Interesante</h4>
            <p class="mb-3 text-justify">
            Para definir exactamente qu√© datos deb√≠an ser cifrados y cu√°les no, se configur√≥ una Lista de Control de Acceso (ACL 100). Esta lista intercepta exclusivamente el tr√°fico que fluye desde la red local (192.168.1.0/24) hacia la red remota (192.168.3.0/24), permitiendo que la navegaci√≥n normal a Internet no pase por el t√∫nel.
            </p>
            <p class="mb-5 text-justify">
            Posteriormente, se defini√≥ el conjunto de transformaci√≥n (Transform-Set). Esta configuraci√≥n dicta c√≥mo se proteger√°n los datos reales. Se opt√≥ por el protocolo <strong>ESP (Encapsulating Security Payload)</strong> usando <strong>AES-256</strong> para la confidencialidad y <strong>SHA-HMAC</strong> para garantizar que los paquetes no fueran alterados.
            </p>

            <h4 class="text-xl font-medium mb-2 text-gray-900 dark:text-white">D. Crypto Map y Activaci√≥n</h4>
            <p class="mb-4 text-justify">
            Todos los elementos anteriores se unificaron dentro de un Crypto Map. Se especific√≥ la IP p√∫blica del "peer" (extremo remoto), se habilit√≥ PFS (Perfect Forward Secrecy) para evitar que la vulneraci√≥n de una llave afecte sesiones pasadas, se estableci√≥ un tiempo de vida de 86,400 segundos (24 horas) para las asociaciones de seguridad, y se aplic√≥ este mapa a la interfaz WAN (G0/0) del router.
            </p>

            <div class="relative bg-[#1e1e1e] text-gray-100 rounded-lg shadow-xl overflow-hidden border border-gray-700 mt-4 mb-8">
                <div class="bg-[#2d2d2d] px-4 py-2 flex items-center gap-2 border-b border-gray-700">
                    <div class="w-3 h-3 rounded-full bg-red-500"></div>
                    <div class="w-3 h-3 rounded-full bg-yellow-500"></div>
                    <div class="w-3 h-3 rounded-full bg-green-500"></div>
                    <span class="ml-2 text-xs text-gray-400 font-mono">cisco-ios ‚Äî config_VPN_R1</span>
                </div>
                <div class="p-4 overflow-x-auto text-sm">
                    <pre class="font-mono leading-relaxed">
<span class="text-gray-500">! --- 1. Activaci√≥n de Licencia Security ---</span>
R1(config)# license boot module c1900 technology-package securityk9
R1(config)# exit
R1# copy running-config startup-config
R1# reload

<span class="text-gray-500">! --- 2. Configuraci√≥n Fase 1 (ISAKMP) ---</span>
R1(config)# crypto isakmp policy 10
R1(config-isakmp)# encryption aes 256
R1(config-isakmp)# authentication pre-share
R1(config-isakmp)# group 5
R1(config)# crypto isakmp key secretkey address 209.165.200.1

<span class="text-gray-500">! --- 3. Tr√°fico Interesante y Transform-Set (Fase 2) ---</span>
R1(config)# access-list 100 permit ip 192.168.1.0 0.0.0.255 192.168.3.0 0.0.0.255
R1(config)# crypto ipsec transform-set R1-R3 esp-aes 256 esp-sha-hmac

<span class="text-gray-500">! --- 4. Unificaci√≥n en el Crypto Map ---</span>
R1(config)# crypto map IPSEC-MAP 10 ipsec-isakmp
R1(config-crypto-map)# set peer 209.165.200.1
R1(config-crypto-map)# set pfs group5
R1(config-crypto-map)# set security-association lifetime seconds 86400
R1(config-crypto-map)# set transform-set R1-R3
R1(config-crypto-map)# match address 100

<span class="text-gray-500">! --- 5. Activaci√≥n en Interfaz WAN ---</span>
R1(config)# interface g0/0
R1(config-if)# crypto map IPSEC-MAP
                    </pre>
                </div>
            </div>

            <h4 class="text-xl font-medium mb-2 text-gray-900 dark:text-white">E. Verificaci√≥n de Topolog√≠a y T√∫nel Activo</h4>
            <p class="mb-4 text-justify">
            Tras concluir la configuraci√≥n, la VPN permanece en un estado latente. Para "despertar" el t√∫nel en la topolog√≠a, se gener√≥ tr√°fico de inter√©s ejecutando un Ping desde la PC-A (Red Local) hacia la PC-C (Red Remota). Una vez iniciado el tr√°fico, los comandos de validaci√≥n demostraron el √©xito de la negociaci√≥n criptogr√°fica:
            </p>
            <ul class="list-disc list-inside space-y-2 text-justify text-gray-700 dark:text-gray-300">
                <li><code>show crypto isakmp sa</code>: Mostr√≥ el estado <strong>QM_IDLE / ACTIVE</strong>, confirmando que ambos routers se autenticaron correctamente y el canal ISAKMP estaba operativo.</li>
                <li><code>show crypto ipsec sa</code>: Permiti√≥ observar el incremento de los contadores <em>"pkts encaps"</em> (paquetes encapsulados) y <em>"pkts encrypt"</em> (paquetes cifrados), garantizando que los pings viajaban ocultos por el t√∫nel y no en texto plano. Con esto se comprob√≥ la operatividad de la topolog√≠a Site-to-Site.</li>
            </ul>
        </div>

        {/* PUNTO 3. Material Multimedia (IMAGEN SOLA) */}
        <div>
            <h3 class="text-2xl font-semibold mb-4 text-blue-500/80">3. Material Multimedia</h3>
            
            <div class="relative transition-all duration-300 hover:scale-[1.01] bg-white dark:bg-gray-900 p-2 rounded-xl mt-4">
                <img 
                    class="w-full rounded-lg shadow-sm border border-gray-200 dark:border-gray-800 object-contain" 
                    src={INFO_TAREA.imagen_demo} 
                    alt="Topolog√≠a VPN IPSec en Packet Tracer" 
                />
            </div>
        </div>

        {/* PUNTO 4. Reflexi√≥n T√©cnica */}
        <div>
            <h3 class="text-2xl font-semibold mb-3 text-blue-500/80">4. Reflexi√≥n T√©cnica y Escenarios Reales</h3>
            <p class="mb-3 text-justify">
            La implementaci√≥n de una VPN IPSec Site-to-Site es una de las habilidades de ingenier√≠a de redes m√°s demandadas en el mundo empresarial. En un escenario real corporativo, alquilar l√≠neas dedicadas y privadas para conectar sucursales en diferentes estados o pa√≠ses resulta extremadamente costoso. IPSec resuelve este problema permitiendo utilizar el Internet p√∫blico, inseguro por naturaleza, para crear un conducto completamente herm√©tico y privado a un bajo costo.
            </p>
            <p class="text-justify">
            Esta pr√°ctica subraya la importancia del detalle t√©cnico. Un simple desajuste en el algoritmo de cifrado (Fase 1), una llave precompartida escrita err√≥neamente, o una Lista de Acceso (ACL) mal definida ocasionar√° que la VPN fracase de forma silenciosa. Adem√°s, el uso del protocolo Perfect Forward Secrecy (PFS) integrado en esta actividad representa un est√°ndar de seguridad moderno, mitigando el impacto de posibles robos de llaves criptogr√°ficas a futuro.
            </p>
        </div>

        {/* PUNTO 5. Referencias T√©cnicas */}
        <div>
            <h3 class="text-2xl font-semibold mb-4 text-blue-500/80">5. Referencias T√©cnicas</h3>
            <ul class="list-disc list-inside space-y-3 text-sm text-gray-700 dark:text-gray-300 marker:text-blue-500 break-words">
                <li>
                    Cisco. (s.f.). Gu√≠a de configuraci√≥n de software de los routers de las series Cisco 850 y Cisco 870 - Configuraci√≥n de un t√∫nel VPN IPSec con un cortafuegos adaptativo. Recuperado el 16 de febrero de 2026. 
                    <a href="https://www.cisco.com/en/US/docs/routers/access/800/850/software/configuration/guide/vpngre.html" target="_blank" rel="noopener noreferrer" class="text-blue-400 hover:underline">Enlace oficial a Cisco Documentation</a>
                </li>
            </ul>
        </div>

      </div>

      {/* PUNTO 6. ZONA DE DESCARGA (Bot√≥n PDF) */}
      <div class="mt-16 pt-10 border-t border-gray-200 dark:border-gray-800 flex flex-col items-center gap-6">
        
        <div class="text-center mb-2">
            <h3 class="text-lg font-bold text-gray-800 dark:text-gray-200">6. Respaldo Acad√©mico Formal</h3>
            <p class="text-sm text-gray-500 max-w-lg mt-1">
            Presiona el siguiente bot√≥n para exportar la versi√≥n formal del documento en PDF correspondiente a esta pr√°ctica.
            </p>
        </div>

        <a 
          href={INFO_TAREA.pdf} 
          download={`Actividad06-IPSec-VPN.pdf`} 
          class="flex items-center gap-2 px-8 py-3 text-base font-bold text-white transition-all bg-blue-600 rounded-full hover:bg-blue-700 hover:shadow-lg hover:shadow-blue-500/30 active:scale-95"
        >
          <Link class="size-5" />
          Exportar a PDF
        </a>

        <a 
          href="/#tareas" 
          class="text-gray-500 hover:text-blue-500 hover:underline flex items-center gap-2 text-sm font-medium transition mt-4"
        >
          ‚Üê Regresar a la lista de tareas
        </a>

      </div>

    </SectionContainer>
  </main>
</Layout>